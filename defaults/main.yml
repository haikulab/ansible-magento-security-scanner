---

# Required packages
magesec__required_packages:
  - python-pip
  - gcc
  - python-dev
  - sendmail

# Scanner packages top install
magesec__scanner_packages:
  - mwscan

## Path to mwscan
magesec__mwscan_path: "/usr/local/bin/mwscan"

## File name for the cron file in /etc/cron.d/{{ magesec__cron_file }}
magesec__cron_file: "magento-security-scanner"

## Target folder to scan - you might want to update this one
magesec__target: /var/www

## Default user for Magento Security Scanner
magesec__user: root

## Default email address for notifications
magesec__email: "root@localhost"

## Rule set to be used for the scanning
magesec__ruleset: magesec

## Allow scanner to follow symlinks
magesec__followsymlinks: "" # set to "--followsymlinks"

## Allow scanner to scan all files, not just code
magesec__deep: "" # change to "--deep"

# Action performed by the cron job ###########################################################
## This here so it can be easily overwritten
magesec__action: "{{ magesec__mwscan_path }} --ruleset {{ magesec__ruleset }} {{ magesec__followsymlinks }} {{ magesec__deep }} {{ magesec__target }} {{ magesec__extras }}"

## use this variable to add post task actions
magesec__extras: "&& echo 'done'"

# Cron env variables #########################################################################
## eg. Email address to which errors should be sent
magesec__cron_variables_to_add:
  - var_name: "MAILTO"
    var_value: "{{ magesec__email }}"
    user: "{{ magesec__user }}"
    state: present
